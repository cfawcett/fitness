{{- /* Expects .GymExercise, .AllExercises, .ActivityID, .ParentIDs */ -}}
{{ $gymExercise := .GymExercise }}
{{ $activityID := .ActivityID }}

<div id="exercise-block-{{$gymExercise.ID}}" class="exercise-block p-4 relative
            {{ if $gymExercise.SupersetWithID }}
              is-superset-child
              before:content-['ðŸ”—']
              before:absolute
              before:top-[-0.5rem] /* Adjusted position for new layout */
              before:left-1/2
              before:-translate-x-1/2
              before:text-2xl
              before:opacity-50
            {{ end }}">

    <button type="button"
            hx-delete="/gym-exercise/{{$gymExercise.ID}}"
            hx-confirm="Are you sure you want to delete this exercise and all its sets?"
            class="absolute top-2 right-2 text-zinc-500 hover:text-red-500 font-bold text-2xl leading-none"
            title="Delete Exercise">
        &times;
    </button>

    <h3 class="text-xl font-bold text-cyan-400 mb-4">{{ $gymExercise.ExerciseDefinition.Name }}</h3>

    <h4 class="font-semibold mt-4 mb-2 text-zinc-300">Sets</h4>
    <div id="sets-container-{{$gymExercise.ID}}" class="flex flex-col space-y-2">
        {{ range $gymExercise.Sets }}
            {{ template "_exercise-set.html" (dict "Set" . ) }}
        {{ end }}
    </div>

    <div class="flex items-center justify-evenly mt-4">
        <button type="button"
                hx-post="/gym-exercise/{{$gymExercise.ID}}/add-set"
                hx-target="#sets-container-{{$gymExercise.ID}}"
                hx-swap="beforeend"
                class="text-cyan-400 hover:text-cyan-300 font-semibold text-sm border-2 p-2 border-cyan-500 rounded-md hover:border-cyan-300">
            + Add Set
        </button>

        {{ if not (index .ParentIDs $gymExercise.ID) }}
            <button type="button"
                    hx-get="/ui/add-exercise-modal/{{$activityID}}?sourceExerciseID={{$gymExercise.ID}}"
                    hx-target="#modal-container"
                    hx-swap="innerHTML"
                    class="text-cyan-400 hover:text-cyan-300 font-semibold text-sm border-2 p-2 border-cyan-500 rounded-md hover:border-cyan-300">
                + Add Superset
            </button>
        {{ end }}
    </div>
</div>