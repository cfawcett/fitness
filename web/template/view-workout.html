{{ template "header" . }}
<body class="bg-zinc-900 text-zinc-200">
<div class="flex md:ml-64">
    <main id="content" class="flex-1 overflow-y-auto pb-40">
        <div class="p-4 md:p-6 max-w-4xl mx-auto">
            <div class="flex justify-between items-start mb-6">
                <div>
                    <div hx-get="/ui/activity-name/{{.Activity.ID}}" hx-trigger="load" hx-swap="outerHTML">
                        <div class="h-9 w-64 rounded bg-zinc-700 animate-pulse"></div>
                    </div>
                    <p class="text-zinc-400 mt-1 text-sm">Completed: {{ .Activity.ActivityTime.Format "Jan 2, 2006 at 3:04 PM" }}</p>
                </div>
                <form action="/workouts/{{.Activity.ID}}/create-edit-draft" method="POST" class="flex-shrink-0">
                    <button type="submit" class="bg-cyan-700 text-white font-bold py-2 px-4 rounded-lg hover:bg-cyan-600 transition-colors flex items-center gap-2">
                        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" class="size-5"><path d="m2.695 14.762-1.262 3.155a.5.5 0 0 0 .65.65l3.155-1.262a4 4 0 0 0 1.343-.886L17.5 5.501a2.121 2.121 0 0 0-3-3L3.58 13.42a4 4 0 0 0-.885 1.343Z" /></svg>
                        <span>Edit</span>
                    </button>
                </form>
            </div>

            {{ if .Activity.Notes }}
                <div class="mb-6">
                    <h2 class="text-xl font-bold mb-2 text-white">Workout Notes</h2>
                    <p class="text-zinc-300 bg-zinc-800/50 border border-zinc-700 rounded-lg p-4 whitespace-pre-wrap">{{ .Activity.Notes }}</p>
                </div>
            {{ end }}

            <h2 class="text-xl font-bold mb-4 text-white">Logged Exercises</h2>
            <div class="space-y-4">
                {{/* ✅ FIX: Assign the group to a variable $group */}}
                {{ range $group := .SupersetGroups }}
                    <div class="rounded-lg bg-zinc-800 border border-zinc-700 overflow-hidden">
                        {{/* Now loop over the exercises within $group */}}
                        {{ range $index, $exercise := $group.Exercises }}
                            <div class="
                                {{ if gt $index 0 }} border-t-2 border-dashed border-zinc-700/50 pt-4 {{ end }}
                                p-4
                            ">
                                {{/* ✅ FIX: Check the length of the $group's exercises */}}
                                {{ if gt (len $group.Exercises) 1 }}
                                    <div class="flex items-center gap-2 mb-3 text-xs uppercase font-bold tracking-wider text-cyan-500">
                                        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" class="size-5">
                                            <path d="M12.232 4.232a2.5 2.5 0 0 1 3.536 3.536l-1.225 1.224a.75.75 0 0 0 1.061 1.06l1.224-1.224a4 4 0 0 0-5.656-5.656l-3 3a4 4 0 0 0 .225 5.881.75.75 0 0 0 1.28-.53l-.225-5.881 3-3Z" />
                                            <path d="m7.768 15.768-3-3a4 4 0 0 1 5.656-5.656l1.225 1.224a.75.75 0 0 0 1.06-1.06l-1.224-1.224a2.5 2.5 0 0 0-3.535-3.536l-3 3a2.5 2.5 0 0 0 0 3.536l3 3a2.5 2.5 0 0 0 3.536 0 .75.75 0 0 0-1.06-1.06a1 1 0 0 1-1.414 0Z" />
                                        </svg>
                                        <span>Superset</span>
                                    </div>
                                {{ end }}
                                <h3 class="font-bold text-xl text-cyan-400">{{ $exercise.ExerciseDefinition.Name }}</h3>

                                <div class="mt-4 text-sm">
                                    <div class="flex items-center -mx-4 px-4 py-2 bg-zinc-900/40 text-zinc-400 font-medium">
                                        <div class="w-1/4">SET</div>
                                        <div class="w-1/4">REPS</div>
                                        <div class="w-1/2">WEIGHT</div>
                                    </div>
                                    <div class="divide-y divide-zinc-700/50 -mx-4">
                                        {{ range $exercise.Sets }}
                                            <div class="flex items-center px-4 py-3">
                                                <div class="w-1/4 font-mono text-zinc-300">#{{ .SetNumber }}</div>
                                                <div class="w-1/4 text-zinc-100">{{ .Reps }}</div>
                                                <div class="w-1/2 text-zinc-100">{{ .WeightKG }} kg</div>
                                            </div>
                                        {{ end }}
                                    </div>
                                </div>
                            </div>
                        {{ end }}
                    </div>
                {{ else }}
                    <p class="text-zinc-400 mt-4">No exercises were logged for this workout.</p>
                {{ end }}
            </div>
        </div>
    </main>
</div>
{{ block "navbar" . }}{{ end }}
</body>