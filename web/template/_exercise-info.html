<div class="p-4 space-y-4">

    <button hx-get="/ui/exercise-list/{{.ActivityID}}"
            hx-target="#exercise-list-container"
            hx-swap="innerHTML"
            hx-include="closest #modal-content"
            class="text-sm text-cyan-400 hover:text-cyan-300 mb-4">
        &larr; Back to Exercise List
    </button>

    <div x-data="{ toggled: false }"
         x-init="setInterval(() => { toggled = !toggled }, 1000)"
         class="relative w-full rounded-lg bg-zinc-700 aspect-video select-none">
        <img src="{{ .Exercise.ImageUrlStart }}" alt="{{ .Exercise.Name }} start" class="absolute inset-0 w-full h-full object-cover rounded-lg">
        <img src="{{ .Exercise.ImageUrlEnd }}" alt="{{ .Exercise.Name }} end"
             class="absolute inset-0 w-full h-full object-cover rounded-lg transition-opacity duration-300"
             :class="toggled ? 'opacity-100' : 'opacity-0'">
    </div>

    <div>
        <h4 class="font-semibold text-white mb-2">{{ .Exercise.Name }} Details</h4>
        <div class="flex flex-wrap gap-2 text-sm">
            <span class="bg-cyan-900/50 text-cyan-300 font-semibold px-3 py-1 rounded-full">
                Primary: {{ .Exercise.PrimaryMuscleGroup }}
            </span>
            {{ range .Exercise.SecondaryMuscles }}
                <span class="bg-zinc-700 text-zinc-300 font-medium px-3 py-1 rounded-full">{{ . }}</span>
            {{ end }}
            <span class="bg-zinc-700 text-zinc-300 font-medium px-3 py-1 rounded-full">{{ .Exercise.Equipment }}</span>
        </div>
    </div>

    <button hx-post="/add-exercise-to-form/{{.ActivityID}}"
            hx-vals='{"exercise_id": {{.Exercise.ID}}}'
            hx-target="#exercise-blocks-container"
            hx-swap="beforeend"
            @click="show = false"
            class="w-full p-2 bg-cyan-700 text-white font-bold rounded-lg hover:bg-cyan-600 transition-colors">
        Add to Current Workout
    </button>

    <hr class="my-4 border-zinc-700">
    <h4 class="font-semibold text-white">Your History</h4>

    {{ range .GroupedHistory }}
        <div class="mt-2 p-3 bg-zinc-900/50 border border-zinc-700 rounded-lg">
            <p class="font-semibold text-sm text-zinc-300">{{ .Activity.ActivityTime.Format "Monday, 02 Jan 2006" }}</p>
            <ul class="text-sm list-disc list-inside text-zinc-400 mt-1">
                {{ range .Sets }}
                    <li>Set {{ .SetNumber }}: {{ .Reps }} reps @ {{ .WeightKG }}kg</li>
                {{ end }}
            </ul>
        </div>
    {{ else }}
        <p class="text-sm text-zinc-500">No previous history for this exercise.</p>
    {{ end }}
</div>